#### Black Widow: Blackbox Data-driven Web Scanning (Oakland'21)

#### Summary
Blackbox web scanning is usually applied to detect web vulnerabilities with no prior knowledge nor the source code of the applications. Web applications maintain complicated states in both server-side and client-side such as sessions and JavaScript events, which render the challenges of thoroughly navigating and exploring the entire applications. Besides, there exist inter-state control-flow and data-flow dependencies making it difficult to detect injection vulnerabilities, e.g., XSS. This paper proposes a tool, Black-Window, to tackle these challenges. Black-Window first constructs a navigation model in a directed graph for the state conversion under different user interactions, where the nodes represent states of the client-side program and the edges are the user actions. The states constitute the page state (URL) and JavaScript program state (events), and the user actions include GET requests, form submissions, iframes, and JavaScript events. Black-Window monitors the browser APIs for JavaScript events and the DOM tree modifications to exact such actions. Black-Window then takes a breadth-first search to traverse the edges in the navigation model. To handle the navigation dependencies, Black-Window always walks from the ''safe'' edges that usually do not change the server-side states, to the desired edge. It identifies the inter-state dependencies by a dynamic, end-to-end taint analysis, which is achieved through injected token reappearance detection. Finally, it injects JavaScript code with specific IDs to each inserted XSS payload to reduce false positives dynamically. The evaluation compares Black-Window with several state-of-the-art scanners on two sets of testing applications: 1) old well-known vulnerable applications; and 2) new production applications. Especially, the paper studies code coverage and vulnerability discovery. The results demonstrate that Black-Window achieves the highest code coverage in all applications compared with other tools, and detects all vulnerabilities that other tools detect. In detail, Black-Window finds 25 vulnerabilities, with 6 previously unknown ones in modern applications, while other tools fail to do so. The analysis reveals that the navigation model, traversal mechanism, and inter-state dependencies all contribute to the improvement of code coverage and bug detection.
